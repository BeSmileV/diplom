\subsubsection{Последовательная диаграмма работы модуля Chats}
Модуль «Chats» обеспечивает обмен сообщениями в реальном времени между пользователями (преподавателями и студентами) посредством WebSocket-соединения. На рисунке~\ref{fig:chats-flow} приведена последовательная диаграмма, демонстрирующая этапы работы чата: открытие приложения, выбор беседы, отправка и приём сообщений, обработку JWT (JSON Web Token — токен авторизации) и переподключение.

Выделены следующие этапы:

\begin{enumerate}
    \item При открытие приложения пользователь переходит в раздел «Чаты», интерфейс пользователя загружает список бесед, получает токен доступа из cookie и устанавливает WebSocket-соединение с сервером, передавая токен;
    \item При выборе чата пользователь выбирает беседу, интерфейс отправляет HTTP-запрос на сервер для получения сообщений чата и отображает их;
    \item При отправке нового сообщения пользователь вводит текст сообщения, интерфейс отправляет его на сервер по WebSocket, сервер сохраняет сообщение и отправляет подтверждение обратно, интерфейс временно показывает отправленное сообщение со статусом «отправляется»;
    \item При получение нового сообщения от другого участника сервер рассылает событие \textit{new\_message} (новое сообщение), интерфейс и боковая панель обновляют сообщения и список бесед;
    \item При редактирование сообщения интерфейс отправляет событие \textit{edit\_message} (редактирование сообщения) на сервер, сервер обновляет сообщение и рассылает обновлённое сообщение всем участникам, интерфейс обновляет текст сообщения;
    \item Когда пользователь просматривает сообщение, интерфейс отправляет событие \textit{read\_message} (сообщение прочитано), сервер обновляет статус сообщения и рассылает обновления, интерфейс и боковая панель отражают изменения;
    \item При истечении срока действия токена доступа интерфейс получает ошибку, запрашивает новый токен JWT через токен обновления, затем повторно подключается к WebSocket и продолжает работу без потери данных.
\end{enumerate}

Таким образом, последовательная диаграмма на рисунке~\ref{fig:chats-flow} отражает полный цикл работы модуля «Chats»: от открытия приложения и установления защищённого соединения до приёма, отправки, редактирования и пометки сообщений, а также автоматического обновления JWT и переподключения WebSocket. 
